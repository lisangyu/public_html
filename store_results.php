<?php
// store_results.php
include('config.php');

// Get the search_id from command-line arguments
$search_id = $argv[1];

// Assume result files are generated by the scripts
$emboss_result = 'emboss_result.txt';
$clustalo_result = 'clustalo_result.txt';
$blast_result = 'blast_result.txt';
$plots_result = 'plots_result.png';  // Plot image generated by Python
$motifs_result = 'motifs_result.txt';  // Motif analysis result

// Read the result files
$emboss_data = file_get_contents($emboss_result);
$clustalo_data = file_get_contents($clustalo_result);
$blast_data = file_get_contents($blast_result);
$plots_data = file_get_contents($plots_result);
$motifs_data = file_get_contents($motifs_result);

// Store the results in MySQL database
$stmt = $pdo->prepare("INSERT INTO results (search_id, emboss_result, clustalo_result, blast_result, plots_result, motifs_result)
                       VALUES (:search_id, :emboss_result, :clustalo_result, :blast_result, :plots_result, :motifs_result)");
$stmt->execute([
    'search_id' => $search_id,
    'emboss_result' => $emboss_data,
    'clustalo_result' => $clustalo_data,
    'blast_result' => $blast_data,
    'plots_result' => $plots_data,
    'motifs_result' => $motifs_data
]);

echo "Results stored successfully.";
?>
